<!DOCTYPE html>
<html>
<head>
    <title>SignalR Simple Chat</title>
	<meta charset="UTF-8">
	    <!--Script references. -->
    <!--Reference the jQuery library. -->
	<script src="static/jquery.js"></script>
    <!--Reference the SignalR library. -->
    <script src="static/jquery.signalR.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="https://192.168.178.21:8080/signalr/hubs"></script>
	<link rel="stylesheet" href="static/bootstrap.min.css" />
	<script src="static/bootstrap.min.js"></script>
	
	<script src="static/react.js"></script>
	<script src="static/react-dom.js"></script>
	<script src="static/babel.js"></script>
</head>
<body>
	<nav class="navbar navbar-default">
	  <div class="container-fluid">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
		  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
			<span class="sr-only">Toggle navigation</span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		  </button>
		  <a class="navbar-brand" href="#">Brand</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
		  <ul class="nav navbar-nav">
			<li class="active"><a href="#">Link <span class="sr-only">(current)</span></a></li>
			<li><a href="#">Link</a></li>
			<li class="dropdown">
			  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdown <span class="caret"></span></a>
			  <ul class="dropdown-menu">
				<li><a href="#">Action</a></li>
				<li><a href="#">Another action</a></li>
				<li><a href="#">Something else here</a></li>
				<li role="separator" class="divider"></li>
				<li><a href="#">Separated link</a></li>
				<li role="separator" class="divider"></li>
				<li><a href="#">One more separated link</a></li>
			  </ul>
			</li>
		  </ul>
		  <form class="navbar-form navbar-left" role="search">
			<div class="form-group">
			  <input type="text" class="form-control" placeholder="Search">
			</div>
			<button type="submit" class="btn btn-default">Submit</button>
		  </form>
		  <ul class="nav navbar-nav navbar-right">
			<li><a href="#">Link</a></li>
			<li class="dropdown">
			  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdown <span class="caret"></span></a>
			  <ul class="dropdown-menu">
				<li><a href="#">Action</a></li>
				<li><a href="#">Another action</a></li>
				<li><a href="#">Something else here</a></li>
				<li role="separator" class="divider"></li>
				<li><a href="#">Separated link</a></li>
			  </ul>
			</li>
		  </ul>
		</div><!-- /.navbar-collapse -->
	  </div><!-- /.container-fluid -->
	</nav>
    
	<div id="machine_container"></div>
	<div id="time_container"></div>
	<div class="container">
	<div id="time"></div>
	<div id="machine"></div>
        <input type="text" id="message" />
        <input type="button" id="sendmessage" value="Send" />
        <input type="hidden" id="displayname" />
        <ul id="discussion"></ul>
    </div>
	
	<script type="text/babel" src="static/machine.js"></script>
	<script type="text/babel" src="static/current_time.js"></script>

	
    <!--Add script to update the page and send messages.-->
    <script type="text/javascript">
        $(function () {
		
			/*//Set the hubs URL for the connection
            $.connection.hub.url = "https://192.168.178.21:8080/signalr";
            // Declare a proxy to reference the hub.
            var chat = $.connection.myHub;
            // Create a function that the hub can call to broadcast messages.
            chat.client.addMessage = function (name, message) {
                // Html encode display name and message.
                var encodedName = $('<div />').text(name).html();
                var encodedMsg = $('<div />').text(message).html();
                // Add the message to the page.
                $('#discussion').append('<li><strong>' + encodedName
                    + '</strong>:&nbsp;&nbsp;' + encodedMsg + '</li>');
            };
			
			chat.client.setTime=function(time){
				$('#time').html(time);
			};
			
			chat.client.machine=function(machine){
				//alert(JSON.stringify(machine));
				$('#machine').html(JSON.stringify(machine, null, 2));
			}
            // Get the user name and store it to prepend to messages.
            //$('#displayname').val(prompt('Enter your name:', ''));
            // Set initial focus to message input box.
            $('#message').focus();
            // Start the connection.
            $.connection.hub.start().done(function () {
                $('#sendmessage').click(function () {
                    // Call the Send method on the hub.
                    chat.server.send($('#displayname').val(), $('#message').val());
                    // Clear text box and reset focus for next comment.
                    $('#message').val('').focus();
                });
            });*/
			/*$.connection.hub.url = "https://192.168.178.21:8080/signalr";
			var chat=$.connection.myHub;
			//this.chat = $.connection.myHub;
			chat.client.machine=function(machine){
				$('#machine').html(JSON.stringify(machine, null, 2));
			}
			$.connection.hub.start().done(function(){
				alert('ici');
			});*/
        });
    </script>
</body>
</html>